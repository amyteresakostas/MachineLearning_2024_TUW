K NEAREST NEIGHBOR CLASSIFICATION


----------------------------------------------------------------------------------------------
--------------------------------------- AMAZON REVIEW ----------------------------------------
----------------------------------------------------------------------------------------------
Baseline - KNN without Scaling
Confusion Matrix:
 [[1 0 0 ... 0 0 0]
 [0 1 0 ... 0 0 0]
 [0 0 1 ... 0 0 0]
 ...
 [0 0 1 ... 0 0 0]
 [0 0 1 ... 0 0 1]
 [0 0 0 ... 0 0 0]]
Accuracy: 0.2
Precision (weighted): 0.44722270322270313
Recall (weighted): 0.2
F1 Score (weighted): 0.18458097458097456
Time:  0.07625198364257812
----------------------------------------------------------------------------------------------
KNN with Scaling
Confusion Matrix:
 [[0 0 0 ... 0 0 0]
 [0 0 2 ... 0 0 0]
 [0 0 2 ... 0 0 0]
 ...
 [0 0 2 ... 0 0 0]
 [0 1 2 ... 0 0 0]
 [0 0 6 ... 0 0 0]]
Accuracy: 0.04666666666666667
Precision (weighted): 0.9106706997378503
Recall (weighted): 0.04666666666666667
F1 Score (weighted): 0.015830140485312897
Time:  0.030690908432006836
----------------------------------------------------------------------------------------------
KNN with Cross Validation (10-fold)
Accuracy: 0.1967
Precision: 0.4510
Recall: 0.1967
F1 Score: 0.1797
Time:  0.8368921279907227
----------------------------------------------------------------------------------------------
Hyperparameter Tuning: find optimal k
Optimal k: 1
Time:  {10.280316352844238}
----------------------------------------------------------------------------------------------
Dimensionality Reduction
Reduced features from 10000 to 8824 after correlation analysis.
Accuracy: 0.2300
Precision: 0.3844
Recall: 0.2300
F1 Score: 0.2155
Time:  0.692507266998291
----------------------------------------------------------------------------------------------
Oversampling using RandomOverSampler
----------------------------------------------------------------------------------------------
KNN with Oversampling
Confusion Matrix:
 [[1 0 0 ... 0 0 0]
 [0 1 0 ... 0 0 0]
 [0 0 1 ... 0 0 0]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 2 1]
 [0 0 0 ... 0 0 4]]
Accuracy: 0.24666666666666667
Precision (weighted): 0.40751851851851856
Recall (weighted): 0.24666666666666667
F1 Score (weighted): 0.24959259259259256
Time:  0.20418071746826172
----------------------------------------------------------------------------------------------
Oversampling - Cross Validation
Accuracy: 0.6689
Precision: 0.7330
Recall: 0.6689
F1 Score: 0.6598
Time:  4.1691575050354
----------------------------------------------------------------------------------------------
Final model
Confusion Matrix:
 [[1 0 0 ... 0 0 0]
 [0 1 0 ... 0 0 0]
 [0 0 1 ... 0 0 0]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 2 1]
 [0 0 0 ... 0 0 4]]
Accuracy: 0.24666666666666667
Precision (weighted): 0.40751851851851856
Recall (weighted): 0.24666666666666667
F1 Score (weighted): 0.24959259259259256
Time:  0.2006218433380127
----------------------------------------------------------------------------------------------
----------------------------------- ROAD TRAFFIC ACCIDENT ------------------------------------
----------------------------------------------------------------------------------------------
Baseline - KNN without Scaling
Confusion Matrix:
 [[  10    3   23]
 [   6   49  261]
 [  14   89 2003]]
Accuracy: 0.838893409275834
Precision (weighted): 0.7999561471706644
Recall (weighted): 0.838893409275834
F1 Score (weighted): 0.8133219434725838
Time:  0.01799941062927246
----------------------------------------------------------------------------------------------
KNN with Scaling
Confusion Matrix:
 [[   1    5   30]
 [   1   33  282]
 [  14  118 1974]]
Accuracy: 0.8169243287225386
Precision (weighted): 0.7679670801383287
Recall (weighted): 0.8169243287225386
F1 Score (weighted): 0.7887182330017571
Time:  0.01300811767578125
----------------------------------------------------------------------------------------------
KNN with Cross Validation (10-fold)
Accuracy: 0.8032
Precision: 0.7416
Recall: 0.8032
F1 Score: 0.7665
Time:  0.8254215717315674
----------------------------------------------------------------------------------------------
Hyperparameter Tuning: find optimal k
Optimal k: 23
Time:  {21.35992956161499}
Accuracy: 0.8427
Precision: 0.8674
Recall: 0.8427
F1 Score: 0.7707
Time:  0.7611699104309082
----------------------------------------------------------------------------------------------
Oversampling using RandomOverSampler
Original class distribution: Accident_severity
Slight Injury     8285
Serious Injury    1426
Fatal injury       121
Name: count, dtype: int64
Resampled class distribution: Accident_severity
Fatal injury      8285
Serious Injury    8285
Slight Injury     8285
Name: count, dtype: int64
----------------------------------------------------------------------------------------------
KNN with Oversampling
Confusion Matrix:
 [[   1   14   21]
 [   1   80  235]
 [  44  544 1518]]
Accuracy: 0.6505288852725793
Precision (weighted): 0.7495917920278009
Recall (weighted): 0.6505288852725793
F1 Score (weighted): 0.6923379471089965
Time:  0.02419257164001465
----------------------------------------------------------------------------------------------
Oversampling - Cross Validation
Accuracy: 0.9021
Precision: 0.9173
Recall: 0.9021
F1 Score: 0.8997
Time:  3.14375376701355
----------------------------------------------------------------------------------------------
Find optimal k with oversampled data
Optimal k: 1
Time:  {82.77657294273376}
----------------------------------------------------------------------------------------------
Accuracy: 0.9462
Precision: 0.9525
Recall: 0.9462
F1 Score: 0.9456
Time:  2.917156934738159
----------------------------------------------------------------------------------------------
Final Model
Confusion Matrix:
 [[   1   10   25]
 [   1   44  271]
 [  21  304 1781]]
Accuracy: 0.7428803905614321
Precision (weighted): 0.7511270635682912
Recall (weighted): 0.7428803905614321
F1 Score (weighted): 0.7468778916093112
Time:  0.024885892868041992
----------------------------------------------------------------------------------------------
-------------------------------------- MACHINE FAILURE ---------------------------------------
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
-------------------------------------- MACHINE FAILURE ---------------------------------------
----------------------------------------------------------------------------------------------
Machine Failure - Without Scaling:
Confusion Matrix:
 [[83 19]
 [22 65]]
Accuracy: 0.783068783068783
Precision: 0.7738095238095238
Recall: 0.7471264367816092
F1 Score: 0.7602339181286549
Time:  0.0020623207092285156
----------------------------------------------------------------------------------------------
Machine Failure - With Scaling:
Confusion Matrix:
 [[88 14]
 [13 74]]
Accuracy: 0.8571428571428571
Precision: 0.8409090909090909
Recall: 0.8505747126436781
F1 Score: 0.8457142857142858
Time:  0.002000570297241211
----------------------------------------------------------------------------------------------
Machine Failure - With Cross Validation:
Accuracy: 0.9126
Precision: 0.8862
Recall: 0.9022
F1 Score: 0.8934
Time: 0.14010000228881836
----------------------------------------------------------------------------------------------
Finding optimal k:
Optimal k: 17
Time:  {3.8228631019592285}
----------------------------------------------------------------------------------------------
Machine Failure - With optimal k=17 (Cross-validation):
Accuracy: 0.9126
Precision: 0.8862
Recall: 0.9022
F1 Score: 0.8934
Time: 0.12074780464172363
----------------------------------------------------------------------------------------------
Machine Failure - Final Model with k=17:
Confusion Matrix:
 [[89 13]
 [ 8 79]]
Accuracy: 0.8888888888888888
Precision: 0.8586956521739131
Recall: 0.9080459770114943
F1 Score: 0.88268156424581
Time:  0.0010027885437011719
----------------------------------------------------------------------------------------------
------------------------------------------- VOTING -------------------------------------------
----------------------------------------------------------------------------------------------
Voting - Without Scaling:
Confusion Matrix:
 [[22  1]
 [ 1 20]]
Accuracy: 0.9545454545454546
Precision: 0.9523809523809523
Recall: 0.9523809523809523
F1 Score: 0.9523809523809523
Time:  0.0010004043579101562
----------------------------------------------------------------------------------------------
Voting - With Scaling:
Confusion Matrix:
 [[22  1]
 [ 1 20]]
Accuracy: 0.9545454545454546
Precision: 0.9523809523809523
Recall: 0.9523809523809523
F1 Score: 0.9523809523809523
Time:  0.0010006427764892578
----------------------------------------------------------------------------------------------
Voting - With Cross Validation:
Accuracy: 0.9418
Precision: 0.9050
Recall: 0.9524
F1 Score: 0.9250
Time: 0.1210329532623291
----------------------------------------------------------------------------------------------
Finding optimal k:
Optimal k: 1
Time:  {3.2082974910736084}
----------------------------------------------------------------------------------------------
Voting - With optimal k=1 (Cross-validation):
Accuracy: 0.9418
Precision: 0.9050
Recall: 0.9524
F1 Score: 0.9250
Time: 0.11961174011230469
----------------------------------------------------------------------------------------------
Voting - Final Model with k=1:
Confusion Matrix:
 [[23  0]
 [ 1 20]]
Accuracy: 0.9772727272727273
Precision: 1.0
Recall: 0.9523809523809523
F1 Score: 0.975609756097561
Time:  0.0010440349578857422
